"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40746],{799098:function(e,t,n){n.d(t,{O:function(){return s}});var o=n(765092),i=n(693981);function s(e,t,n,s){let r=(0,i.useRef)(t);(0,o.L)(()=>{r.current=t},[t]),(0,i.useEffect)(()=>{var t;let o=null!==(t=null==n?void 0:n.current)&&void 0!==t?t:window;if(!(o&&o.addEventListener))return;let i=e=>r.current(e);return o.addEventListener(e,i,s),()=>{o.removeEventListener(e,i,s)}},[e,n,s])}},170439:function(e,t,n){n.r(t),n.d(t,{AccountDetailsSection:function(){return d},Entry:function(){return i}});var o,i,s=n(29541),r=n(693981),l=n(13811);(o=i||(i={})).MODAL="modal",o.NON_MODAL="non_modal";let d=e=>{let{navigateToSignUp:t=!1,closeLoginModal:n,entry:o}=e,{isGuest:i,loading:d,handlePostMessage:a,iframeRef:c,frameUrl:u,iframeHeight:g}=(0,l.J)(t,"modal"===o,n);return(0,r.useEffect)(()=>(i&&window.addEventListener("message",a),()=>window.removeEventListener("message",a)),[i,d]),i&&!d?(0,s.jsx)("iframe",{width:"100%",title:"Login/Signup",src:u,ref:c,height:g,style:{border:"unset",display:"block"}}):null};t.default=d},341528:function(e,t,n){n.d(t,{AA:function(){return a},LU:function(){return u},Yi:function(){return r},ee:function(){return c},iS:function(){return d},mj:function(){return s},q$:function(){return l}});var o=n(510888),i=n(903359);let s=i.default.div.withConfig({componentId:"sc-6048d514-0"})(["position:relative;"]),r=i.default.div.withConfig({componentId:"sc-6048d514-1"})(["padding-left:0;margin:0;background-color:",";border:1px solid ",";border-radius:","px;overflow-y:auto;z-index:1000;width:100%;"," ",""],o.Colors.PageBackgroundPrimary,e=>{let{isNewDesignEnabled:t}=e;return t?o.Colors.BorderPrimary:o.Colors.BorderSecondary},o.BorderRadius.Small,e=>{let{isNewDesignEnabled:t}=e;return!t&&"max-height: ".concat(250,"px;")},e=>{let{isStaticPositionSuggestions:t,shouldFlipResults:n,isLabelHidden:s,isNewDesignEnabled:r}=e;return(0,i.css)(["position:",";"," ",""],t?"static":"absolute",n?(0,i.css)(["bottom:",";"],s?"100%":"65%"):"top: 100%;",r&&"\n        border-radius: ".concat(o.BorderRadius.Large,"px;\n        box-shadow: ").concat(o.Shadows.Medium,";\n      "))}),l=(0,i.default)(o.Text).attrs(()=>({styles:o.Text.Styles.Regular14})).withConfig({componentId:"sc-6048d514-2"})(["display:flex;align-items:center;color:inherit;text-decoration:inherit;min-height:","px;border-top:1px solid ",";padding:","px ","px;background-color:",";&:first-child{border-top:none;}&:last-child{position:sticky;bottom:0;width:100%;}"],o.Spacing.XxLarge,o.Colors.BorderSecondary,o.Spacing.XxxSmall,o.Spacing.Medium,e=>{let{active:t}=e;return t?o.Colors.PageBackgroundSecondary:o.Colors.PageBackgroundPrimary}),d=i.default.div.withConfig({componentId:"sc-6048d514-3"})([""]),a=(0,i.default)(l).withConfig({componentId:"sc-6048d514-4"})(["cursor:pointer;"]),c=i.default.div.withConfig({componentId:"sc-6048d514-5"})(["display:flex;justify-content:center;align-items:center;",""],e=>{let{hasMarginLeft:t}=e;return t&&"margin-left: ".concat(o.Spacing.XxSmall,"px;")}),u=i.default.div.withConfig({componentId:"sc-6048d514-6"})(["padding:","px;display:flex;justify-content:flex-end;"," picture{display:block;width:",";}"],o.Spacing.Small,e=>{let{hasBorderTop:t}=e;return t&&"border-top: 1px solid ".concat(o.Colors.BorderPrimary,";")},e=>{let{size:t}=e;return"".concat(t,"px")})},145187:function(e,t,n){n.d(t,{e:function(){return a},f:function(){return d}});var o=n(29541),i=n(693981),s=n(620295),r=n(411805);let l=i.createContext({isStaticPosition:!1,isEnabled:!1,showBoxShadow:!0,addressSuggestions:[],queryCalled:!1,shouldRenderAddressSuggestions:!1,showErrorMessage:!1,showSuggestionsList:!1,showNearByTitleWithLoading:!1,showGetCurrentLocationButton:!1,isLoading:!1,shouldStartFetchingAddress:!1,providerExistsAsParent:!1,fetchGeoLocationAddresses:()=>{},requestGeoLocationPermissionOnLoad:!1}),d=()=>{var e;let t=i.useContext(l);return(null==r?void 0:null===(e=r.env)||void 0===e?void 0:"production")!=="development"||(null==t?void 0:t.providerExistsAsParent)||console.error("useGeoLocationSuggestionsContext must be used within a GeoLocationSuggestionsProvider"),t},a=e=>{let{isEnabled:t=!1,isStaticPosition:n,showBoxShadow:r,children:d,showSuggestionOnInputFocus:a=!1,requestGeoLocationPermissionOnLoad:c=!1}=e,{fetchGeoLocationAddresses:u,addressList:g,loading:p,geoError:h,addressFetchError:f,geoLocationPermission:v,queryCalled:m,addressExistsOnSessionStorage:_}=(0,s.T)(),x=t&&(null==v?void 0:v.state)!==(null===s.m||void 0===s.m?void 0:s.m.DENIED)&&!h&&!((null==v?void 0:v.state)===(null===s.m||void 0===s.m?void 0:s.m.PROMPT)&&c),w=!!f&&!p,S=m&&!g.length&&!p&&!w,b=!(null==g?void 0:g.length)&&(null==v?void 0:v.state)===(null===s.m||void 0===s.m?void 0:s.m.PROMPT)&&!c,P=p&&!(null==g?void 0:g.length),y=f||S,E=!!(null==g?void 0:g.length)&&!y,L=(null==v?void 0:v.state)===(null===s.m||void 0===s.m?void 0:s.m.GRANTED)&&P&&!_,C=t&&((null==v?void 0:v.state)===(null===s.m||void 0===s.m?void 0:s.m.GRANTED)&&!_||c);i.useEffect(()=>{C&&u()},[C]);let k=i.useMemo(()=>({isEnabled:t,isStaticPosition:n,showBoxShadow:r,addressSuggestions:g,queryCalled:m,shouldRenderAddressSuggestions:x,showErrorMessage:y,showSuggestionsList:E,showNearByTitleWithLoading:L,showGetCurrentLocationButton:b,isLoading:P,shouldStartFetchingAddress:C,showSuggestionOnInputFocus:a,providerExistsAsParent:!0,fetchGeoLocationAddresses:u,requestGeoLocationPermissionOnLoad:c}),[t,n,r,g.length,m,x,y,E,b,L,P,null==v?void 0:v.state,C,a,u,c]);return(0,o.jsx)(l.Provider,{value:k,children:d})}},694424:function(e,t,n){n.d(t,{Ek:function(){return h},N:function(){return a},Y3:function(){return v},ct:function(){return f},jn:function(){return c},rb:function(){return u}});var o=n(317905),i=n(510888),s=n(903359),r=n(341528);function l(){let e=(0,o._)(["\n    padding: 0 ","px;\n  "]);return l=function(){return e},e}function d(){let e=(0,o._)(["\n    padding: 0px;\n    font-weight: 600;\n  "]);return d=function(){return e},e}let a=(0,s.default)(r.Yi).attrs(e=>({tabindex:e.tabIndex})).withConfig({componentId:"sc-10c1a9e5-0"})([""," border-radius:","px;margin-top:","px;"],e=>e.showBoxShadow&&(0,s.css)(["box-shadow:",";"],i.Shadows.Base),i.BorderRadius.Small,i.Spacing.XxxxSmall),c=(0,s.default)(r.AA).attrs(e=>({tabindex:e.tabIndex})).withConfig({componentId:"sc-10c1a9e5-1"})(["font-size:15px;color:",";padding:0px ","px;align-items:center;min-height:","px;"," ","   "," &:first-child{border-bottom:none;color:",";}&:last-child{position:static;}"," "," ","  .geo-location-address-list-cell-title{font-size:15px;}"],i.Colors.TextSecondary,i.Spacing.Large,36,e=>e.hover&&(0,s.css)(["&:hover{background-color:",";}"],i.Colors.BackgroundSecondary),e=>e.isTitle&&(0,s.css)(["font-weight:",";padding:","px ","px;"],i.Text.Weights.Bold,i.Spacing.XxSmall,i.Spacing.Large),e=>!e.clickAble&&(0,s.css)(["cursor:initial;"]),i.Colors.TextSecondary,i.Media.MobileOnly(l(),i.Spacing.XxSmall),e=>e.disablePadding&&(0,s.css)(["padding:0;"]),e=>e.sticky&&(0,s.css)(["position:sticky;z-index:99;"])),u=s.default.div.withConfig({componentId:"sc-10c1a9e5-2"})(["margin-left:auto;",""],e=>e.addRightMargin&&(0,s.css)(["margin-right:","px;"],i.Spacing.Large)),g=s.default.button.withConfig({componentId:"sc-10c1a9e5-3"})(["display:flex;align-items:center;line-height:","px;cursor:pointer;border:none;background-color:inherit;padding:0px;font-size:15px;"],i.Text.LineHeights.S14),p=(0,s.css)(["width:100%;display:grid;grid-template-rows:auto auto auto;grid-template-columns:auto 1fr;grid-column-gap:","px;padding:0px;"],i.Spacing.Small),h=(0,s.default)(g).withConfig({componentId:"sc-10c1a9e5-4"})(["font-family:inherit;max-width:100%;font-weight:bold;text-align:left;color:",";",";padding:","px ","px;",""],i.Colors.TextSecondary,p,i.Spacing.XxxxSmall,i.Spacing.Large,i.Media.MobileOnly(d())),f=(0,s.default)(g).withConfig({componentId:"sc-10c1a9e5-5"})(["min-height:","px;display:flex;flex-direction:row;align-items:top;width:100%;font-family:inherit;div > div{padding-left:0px;}> div:first-of-type{padding:0px !important;}"],36),v=s.default.span.withConfig({componentId:"sc-10c1a9e5-6"})(["font-weight:bold;color:",";",";align-items:center;text-align:left;svg{vertical-align:middle;}"],i.Colors.TextError,p)},418702:function(e,t,n){n.d(t,{Z:function(){return b}});var o=n(693981),i=n(145187),s=n(29541),r=n(510888),l=n(694424),d=n(324307),a=n(22194),c=n(423188),u=n(128669),g=n(863845);let p=e=>{let{isEnabled:t=!1,inputFieldId:n,suggestionsContainerRef:i,queryCalled:s=!1}=e,[r,l]=(0,o.useState)(!t);return(0,o.useEffect)(()=>{if(t&&n){let e=e=>{var t;(null==i?void 0:null===(t=i.current)||void 0===t?void 0:t.contains(e.relatedTarget))||l(!1)},t=e=>{var t;let n=e.target;(null==n?void 0:null===(t=n.value)||void 0===t?void 0:t.length)||l(!0)},o=document.getElementById(n);return null==o||o.addEventListener("focus",t),null==o||o.addEventListener("blur",e),()=>{null==o||o.removeEventListener("focus",t),null==o||o.removeEventListener("blur",e)}}return t&&!n&&console.error("GeolocationSuggestions component won't work as expected. We need to provide `inputFieldId` prop if `showSuggestionOnInputFocus` is disabled"),()=>void 0},[]),(0,o.useEffect)(()=>{if(t&&s&&r){let e=document.getElementById(n);null==e||e.focus()}},[s,n,t,r]),{showUI:r}},h=e=>{let{loading:t,onClick:n,hideGetLocationButton:o}=e;return(0,s.jsxs)(l.jn,{disablePadding:!0,hover:!0,children:[!o&&(0,s.jsxs)(l.Ek,{onClick:n,"data-testid":"geo-location-address-suggestions-button",children:[(0,s.jsx)(r.Icon,{type:r.Icon.Types.LocationPinEnabledFill,size:r.Icon.Sizes.Medium}),c.ZP.t("address_suggestion_use_current_location")]}),t&&(0,s.jsx)(l.rb,{addRightMargin:!0,children:(0,s.jsx)(d.default,{size:d.default.Sizes.Small,"data-testid":"geo-location-address-suggestions-loading-indicator"})})]})},f=e=>{let{address:t,onSelect:n}=e;return(0,s.jsx)(l.jn,{hover:!0,onClick:()=>{(0,u.ZP)("cx_geo_location_address_suggestion_address_click",{address:t}),n(t)},children:(0,s.jsx)(l.ct,{children:(0,s.jsx)(a.ZP,{iconStart:{isInteractive:!1,type:r.Icon.Types.LocationPointerFill,size:r.Icon.Sizes.Medium},title:t.street,subtext:"".concat(t.city,", ").concat(t.state," ").concat(t.zipCode),size:a.ZP.Sizes.Small,insetSize:a.ZP.InsetSizes.ModalActionButtonsInline,isSeparatorVisible:!1,isToggled:!1,isSquished:!0,titleOverrides:{className:"geo-location-address-list-cell-title"}})})})},v=()=>(0,s.jsx)(l.jn,{clickAble:!1,onMouseDown:e=>e.preventDefault(),"data-testid":"geo_location_address_suggestions_error_message",children:(0,s.jsxs)(l.Y3,{children:[(0,s.jsx)(r.Icon,{type:r.Icon.Types.ErrorFill,color:r.Icon.Colors.TextError}),c.ZP.t("address_suggestion_error_message")]})}),m=e=>{let{loading:t=!1}=e;return(0,s.jsxs)(l.jn,{clickAble:!1,onMouseDown:e=>e.preventDefault(),sticky:!0,isTitle:!0,children:[c.ZP.t("address_suggestion_nearby_addresses"),t&&(0,s.jsx)(l.rb,{children:(0,s.jsx)(d.default,{size:d.default.Sizes.Small})})]})},_=o.memo(e=>{let{onAddressSelect:t=()=>{},addressPickerInputId:n=null,isAddressPickerInputEmpty:r=!0,renderItemAfterContent:d,enableHoverOnItemAfterContent:a=!1,hideGetLocationButton:c=!1}=e,{showGetCurrentLocationButton:g,showNearByTitleWithLoading:_,isLoading:x,showSuggestionsList:w,showErrorMessage:S,addressSuggestions:b,shouldRenderAddressSuggestions:P,isStaticPosition:y,showBoxShadow:E,showSuggestionOnInputFocus:L,fetchGeoLocationAddresses:C,queryCalled:k}=(0,i.f)(),I=o.useRef(null),{showUI:A}=p({isEnabled:L,inputFieldId:n,suggestionsContainerRef:I,queryCalled:k});return P&&A&&r?(0,s.jsxs)(l.N,{isLabelHidden:!0,shouldFlipResults:!1,isStaticPositionSuggestions:y,showBoxShadow:E,"data-testid":"geo-location-address-suggestions-container",ref:I,tabIndex:-1,isNewDesignEnabled:!1,children:[g&&(0,s.jsx)(h,{onClick:()=>{C(),(0,u.ZP)("cx_geo_location_address_suggestion_get_current_location_button_click")},loading:x,hideGetLocationButton:c}),_&&(0,s.jsx)(m,{loading:x}),S&&(0,s.jsx)(v,{}),w&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m,{}),b.map(e=>(0,s.jsx)(f,{address:e,onSelect:()=>t(e)},e.printableAddress))]}),d&&(0,s.jsx)(l.jn,{hover:a,children:d})]}):null});_.displayName="GeoLocationAddressSuggestions";let x=e=>{let{isEnabled:t}=(0,i.f)();return t?(0,s.jsx)(g.Z,{children:(0,s.jsx)(_,{...e})}):null};x.displayName="GeoLocationAddressSuggestionsContainer";var w=o.memo(x);let S=()=>null;S.Provider=i.e,S.List=w;var b=S},394344:function(e,t,n){var o=n(29541),i=n(587225),s=n(693981),r=n(170439),l=n(867015),d=n(423188),a=n(128669),c=n(577917);t.Z=e=>{let{setShowSignInSignUpModal:t,onClose:n,showSignUpView:u=!1}=e,{useGuidedLayout:g}=(0,l.m)(),[p,h]=(0,s.useState)(!0),f=(0,s.useCallback)(()=>{h(!1)},[h]),v=(0,s.useCallback)(()=>{(0,a.ZP)("signin_modal_closed"),t(!1),n()},[t,n]);return((0,s.useEffect)(()=>{!p&&g&&v()},[p,g,v]),g)?p?(0,o.jsx)(i.Modal,{"data-testid":c.GO.loginModalGuided,shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,hasContentPadding:!1,hasHeaderPadding:!1,hasCloseButton:!1,shouldRenderStickyHeader:!1,onClose:f,children:(0,o.jsx)(r.default,{navigateToSignUp:u,closeLoginModal:f,entry:r.Entry.MODAL})}):null:(0,o.jsx)(i.Modal,{"data-testid":c.GO.loginModal,hasContentPadding:!1,hasHeaderPadding:!0,hasCloseButton:!0,onClose:v,title:d.ZP.t("layoutStrings_header_signin_signup"),children:(0,o.jsx)(r.default,{navigateToSignUp:u,entry:r.Entry.MODAL,closeLoginModal:v})})}},13811:function(e,t,n){n.d(t,{J:function(){return h}});var o,i,s,r,l=n(693981),d=n(435999),a=n(128669),c=n(867015),u=n(298296),g=n(450165),p=n(59825);(o=s||(s={})).SOCIAL="social",o.EXIT="exit",o.SUCCESS="success",o.HEIGHT="height",o.FAILED="failed",o.SEND_HEIGHT="sendHeight",o.SUCCESS_POST_LOGIN="successPostLogin",o.SUCCESS_POST_SIGNUP="successPostSignup",o.FAILED_POST_LOGIN="failedPostLogin",o.CLOSE_MODAL="closeModal",(i=r||(r={})).LOGIN="login",i.SIGNUP="signup";let h=(e,t,n,o)=>{let i=(0,g.qr)(e=>e.clientCookies),{useGuidedLayout:s,queryParms:r={}}=(0,c.m)();t&&(r.is_iframe_modal=!0);let{consumer:h,loading:f}=(0,d.R)(),v=(0,l.useRef)(),m=(0,l.useRef)(null),[_,x]=(0,l.useState)("500px"),{isGuest:w}=h,{getLoginUrl:S,getLogoutUrl:b}=(0,p.Yq)(),P=(0,l.useCallback)(e=>{let t=window.screen.width/2-225,n=window.screen.height/2-365;v.current&&!v.current.closed?v.current.location.replace(e):v.current=window.open(e,"window","menubar=no,location=no,resizable=no,scrollbars=no,status=no, width=".concat(450,",height=").concat(730,",top=").concat(n,", left=").concat(t))},[]),y=(0,l.useCallback)(e=>{if(/^react-devtools/gi.test(e.data.source))return;let t=e=>{if(window.removeEventListener("message",y),v&&v.current){var t;(0,a.ZP)("checkout_social_post_".concat(e,"_success")),null===(t=v.current)||void 0===t||t.close()}else(0,a.ZP)("checkout_post_".concat(e,"_success"));null==n||n(),o?window.location.href=o:window.location.reload()};if(e.origin.includes("https://identity.doordash.com")||e.origin.includes("https://www.doordash.com")||e.origin.includes("https://www.trycaviar.com")||e.origin.includes("https://qa.trycaviar.com")||e.origin.includes("https://www.qa.trycaviar.com")||e.origin.includes("https://www.doordashtest.com")||e.origin.includes("https://www.identity-service.doorcrawl.com")||e.origin.includes("https://www.page-service.doordash.com")||e.origin.includes("https://www.page-service-qa.doordash.com")||e.origin.includes("https://page-service-qa.doordash.com")||e.origin.includes("https://identity-service.doorcrawl.com")){let o=null==e?void 0:e.data;if(null==o?void 0:o.action){var s,r,l,d,c,g,p;switch(null==o?void 0:o.action){case"social":P(o.socialLink);break;case"exit":null===(s=v.current)||void 0===s||s.close();break;case"successPostLogin":t("login");break;case"successPostSignup":let e=new Date;e.setFullYear(e.getFullYear()+1),i.set(u.E.new_user_signup,!0,{expires:e}),t("signup");break;case"success":v&&v.current?((0,a.ZP)("checkout_social_iframe_login_success"),null===(r=v.current)||void 0===r||r.close()):(0,a.ZP)("checkout_iframe_login_success"),null==n||n();break;case"height":(0,a.ZP)("checkout_iframe_height"),m.current&&x(o.height+"px");break;case"sendHeight":null===(c=m.current)||void 0===c||null===(d=c.contentWindow)||void 0===d||null===(l=d.postMessage)||void 0===l||l.call(d,{action:"VIEWPORT_HEIGHT",height:window.innerHeight},"*");break;case"closeModal":null==n||n();break;case"failedPostLogin":(0,a.ZP)("checkout_account_post_login_failed"),(0,a.ZP)("signin_modal_closed"),null==v||null===(g=v.current)||void 0===g||g.close(),fetch(b(),{redirect:"manual"});break;case"failed":(0,a.ZP)("checkout_account_login_failed"),null==v||null===(p=v.current)||void 0===p||p.close()}}}},[P,n,o,i,b]);return{isGuest:w,loading:f,handlePostMessage:y,handleSocialLoginPopup:P,iframeRef:m,frameUrl:S({applyDefaultSettings:!0,settings:{layout:s?"guided_consumer_web_iframe":"identity_web_iframe",scope:"*",prompt:"none",responseType:"code"},additionalParams:r,navigateToSignUp:e,redirectBackAfterLogIn:!0}),iframeHeight:_}}},764411:function(e,t,n){var o=n(693981),i=n(128669),s=n(450165),r=n(430790);let l=["www.doordashtest.com"];t.Z=e=>{let{isDoorDash:t}=(0,r.useExperience)(),n="true"===(0,s.qr)(e=>e.clientCookies).get("dx_login_in_modal_enabled_override"),[d,a]=(0,o.useState)(!1),[c,u]=(0,o.useState)(!1),g=(0,o.useCallback)(()=>a(!1),[]),p=(0,o.useCallback)(()=>{(0,i.ZP)("signin_modal_opened",{use_case:e||""}),a(!0)},[e]);return!n&&l.includes(window.location.host)?{showLoginInModalExpEnabled:!1,showSignInSignUpModal:!1,setShowSignInSignUpModal:a,showSignUpView:c,setShowSignUpView:u,hideSignInSignUpModal:g,onIdentityLinkClick:p}:{showLoginInModalExpEnabled:t||n,showSignInSignUpModal:d,setShowSignInSignUpModal:a,showSignUpView:c,setShowSignUpView:u,hideSignInSignUpModal:g,onIdentityLinkClick:p}}},863845:function(e,t,n){var o=n(693981);t.Z=e=>{let{children:t}=e,[n,i]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{i(!0)},[]),n)?t:null}},867015:function(e,t,n){n.d(t,{m:function(){return s}});var o=n(45177),i=n(337088);let s=()=>({useGuidedLayout:"treatment"===(0,o.useDVSString)(i.P.guidedWebLookupLogin,"control")})},620295:function(e,t,n){n.d(t,{m:function(){return i},T:function(){return S}});var o,i,s=n(693981),r=n(317905),l=n(900403),d=n(235962);function a(){let e=(0,r._)(["\n  query getAddressByPoint($lat: Float!, $lng: Float!) {\n    getAddressByPoint(lat: $lat, lng: $lng) {\n      addressesList {\n        city\n        street\n        city\n        zipCode\n        state\n        countryShortname\n        printableAddress\n        lat\n        lng\n        id\n      }\n    }\n  }\n"]);return a=function(){return e},e}let c=(0,l.gql)(a());var u=()=>{var e,t;let[n,{loading:o,error:i,data:r,called:l}]=(0,d.t)(c,{fetchPolicy:"network-only",errorPolicy:"all"}),a=s.useMemo(()=>{var e,t;return(null==r?void 0:null===(t=r.getAddressByPoint)||void 0===t?void 0:null===(e=t.addressesList)||void 0===e?void 0:e.filter(e=>e.city&&e.street&&e.zipCode).map(e=>{let{id:t,...n}=e;return{...n,googlePlaceId:t,shortname:e.street}}))||[]},[null==r?void 0:null===(e=r.getAddressByPoint)||void 0===e?void 0:e.addressesList]);return{getAddressQuery:n,loading:o,called:l,error:i||(null==r?void 0:null===(t=r.getAddressByPoint)||void 0===t?void 0:t.addressesList)===null,data:a}},g=n(713289),p=n(128669),h=n(776801),f=n(312753);let v="dd-geo-location-user-addresses",m=e=>36e5*e,_=e=>{let{fetchedAddressList:t=[],isEnabled:n=!0,storageTtlInHour:o=4}=e,[i,r]=(0,s.useState)([]),[l,d]=(0,s.useState)([]);return(0,s.useEffect)(()=>{let{timeCreated:e,addressList:t}=f.N1.get(v)||{};Date.now()<e+m(o)?d(t):(f.N1.delete(v),d([]))},[]),(0,s.useEffect)(()=>{n&&(l.length&&!t.length?r(l):t.length&&(f.N1.set(v,{timeCreated:Date.now(),addressList:t}),r(t)))},[t.length,n,l.length]),{addressExistsOnSessionStorage:!!l.length,addressList:i}};var x=n(189305);(o=i||(i={})).PROMPT="prompt",o.GRANTED="granted",o.DENIED="denied";let w={state:null,GRANTED:"granted",PROMPT:"prompt",DENIED:"denied"},S=function(){var e,t;let{useSessionStorage:n=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[o,i]=(0,s.useState)(null),{getAddressQuery:r,loading:l,data:d,error:a,called:c}=u(),{addressExistsOnSessionStorage:f,addressList:v}=_({fetchedAddressList:d,isEnabled:n&&"granted"===o}),m=v.length?v:d,S=(0,x.s)(),{error:b,updateCurrentPosition:P,loading:y,position:E,grantedGeolocationPermission:L,hasAskedForGeolocationPermission:C}=(0,g.Z)({usePermissionsApi:!1,isServerSide:S});(0,h.ZP)(()=>{(null==m?void 0:m.length)&&(0,p.ZP)("cx_use_geo_location_address_suggestions_fetch_success",{addressList:m})},[m]),(0,s.useEffect)(()=>{var e,t;null===(t=navigator)||void 0===t||null===(e=t.permissions)||void 0===e||e.query({name:"geolocation"}).then(e=>{"prompt"===o&&"granted"===e.state?(0,p.ZP)("cx_use_geo_location_address_permission_granted"):"prompt"===o&&"denied"===e.state&&(0,p.ZP)("cx_use_geo_location_address_permission_denied"),i(e.state),e.onchange=function(){i(e.state)}})},[b,null==E?void 0:null===(e=E.coords)||void 0===e?void 0:e.latitude,null==E?void 0:null===(t=E.coords)||void 0===t?void 0:t.longitude]),(0,s.useEffect)(()=>{navigator.permissions||(C&&!L?i("denied"):C&&L?i("granted"):i("prompt"))},[C,L]);let k=(0,s.useCallback)(async()=>{if(!b&&!y){var e,t,n,o;try{let o=await P();r({variables:{lat:(null==o?void 0:null===(e=o.coords)||void 0===e?void 0:e.latitude)||0,lng:(null==o?void 0:null===(t=o.coords)||void 0===t?void 0:t.longitude)||0}}),(null===(n=navigator)||void 0===n?void 0:n.permissions)||C||L||(0,p.ZP)("cx_use_geo_location_address_permission_granted")}catch(e){(null==e?void 0:e.code)===(null==e?void 0:e.PERMISSION_DENIED)?(null===(o=navigator)||void 0===o?void 0:o.permissions)||(0,p.ZP)("cx_use_geo_location_address_permission_denied"):a?(0,p.ZP)("cx_use_geo_location_address_suggestions_fetch_error",{error:a}):(0,p.ZP)("cx_use_geo_location_address_permission_error",e)}}},[]);return{addressList:m.length?m:[],fetchGeoLocationAddresses:k,geoLocationPermission:{...w,state:o},loading:y||l,geoError:!!b,addressFetchError:!!a,queryCalled:c,addressExistsOnSessionStorage:f}}}}]);